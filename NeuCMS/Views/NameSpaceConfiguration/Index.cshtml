@using Lib.Web.Mvc.JQuery.JqGrid
@using NeuCMS.Models
@using NeuCMS.HtmlHelpers
@{
    var grid = new JqGridHelper<NameSpaceGridModel>("namespaces",
                                                    caption: "NameSpaces",
                                                    dataType: Lib.Web.Mvc.JQuery.JqGrid.JqGridDataTypes.Json,
                                                    footerEnabled: true,
                                                    methodType: Lib.Web.Mvc.JQuery.JqGrid.JqGridMethodTypes.Post,
                                                    pager: true,
                                                    rowsList: new List<int> {10, 20, 30, 40, 50},
                                                    rowsNumber: 10,
                                                    sortingName: "Id",
                                                    sortingOrder: JqGridSortingOrders.Asc,
                                                    url: Url.Action("NameSpaces"),
                                                    userDataOnFooter: true,
                                                    viewRecords: true,
                                                    onSelectRow: "rowSelected"

        ).Navigator(
            options: new JqGridNavigatorOptions() {Add = true, Delete = false, Edit = false, Search = false, Refresh = false, AddFunction = "addNameSpace"}
        );
}

@section JavaScript
{
    <script type="text/javascript">
        $(document).ready(function() {
            @grid.GetJavaScript();
            $("#editNamespaceDiv").jqm({modal:true});
        });

    var lastSelected;
    function rowSelected(id) {
        $.get("@Url.Action("EditNameSpace")" + "?id=" + id, function(data) {
            $('#formData').replaceWith(data);
            $("#editNamespaceDiv").jqmShow();
        });
        
        $('#namespaces').jqGrid('resetSelection');
    }

    function addNameSpace() {
        $.get("@Url.Action("EditNameSpace")" + "?id=0", function(data) {
            $('#formData').replaceWith(data);
            $("#editNamespaceDiv").jqmShow();
        });
        
        $('#namespaces').jqGrid('resetSelection');
    }    
    </script>
}
@grid.GetHtml()
<div id="namespaceDetail">
    @Html.BeginJQModal("editNamespaceDiv","NameSpace")
    <div id="formData"></div>
    @Html.EndJQMOdal()
</div>
